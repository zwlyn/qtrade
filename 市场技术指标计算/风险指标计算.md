# FFn(Financial Functions for Python)是一个包含许多有用功能的Python库，它的作用是为从事量化交易的工作者提供很多的量化分析方法，
包括回测结果的度量和评估图形化和数据转换。安装：pip install ffn

# 风险指标的计算
在对一个策略进行历史回测时，评估量化策略是否有效是一项重要的环节。在量化回测过程中经常用风险指标对策略的回测结果进行客观的评估，
常用的风险指标有年化收益率、最大回撤率、Alpha、Beta等。
每种风险指标都有其应用的场景和分析的角度。

# 策略收益率
策略收益率（Total Return）是一个用于衡量策略好坏最为直观的概念，它代表了策略从开始到结束，总资产的变化率。计算方法如下：
Total Return = (P(end) - P(start)) / P(start) * 100% 式中P(start)和P(end)分别代表策略开始时和结束时的资产数额。

# 策略年化收益率
策略年化收益率（Total Annualized Return）也是一个常用的风险指标。它是把当前的收益率换算成年收益率来计算的，当前的收益率可能是一周的
收益率，也可能是一个月的收益率，它是真正获取到的收益率，而年化收益率是一种理论收益率，并不是真正获取到的收益率。年化收益率是变动的，
它通常不会和年收益率相等，一般情况下，年化收益率都是要高于实际的年收益率。
Total Annualized Returns = ((1+P)^(250/n) -1)* 100% 式中n为策略执行的时间，P为这段时间内的策略收益率

# 贝塔
介绍贝塔前先介绍基准收益率（Benchmark Returns）。基准收益率又称基准折现率，它是衡量一个策略好坏的基本标准。例如，一个股票策略一年的
收益率有50%，但是这一年来上证指数上涨了100%，所以在评价一个策略好坏时还需要指定一个标准来衡量它的优劣性，这个标准就是基准收益率。一般
对于股票策略来说，上证指数常作为 其评判的基准，如果策略的收益率高于上证指数的收益率，那么就叫作跑赢了基准收益率；如果低于上证指数的收益率，
那么就叫跑输了基准收益率。所以，一个好的策略的收益率至少要高于基准收益率。
贝塔就是用于衡量策略与基准之间的相关性的指标。在一个股票策略中，基准如果选取为上证指数，那么贝塔就用于衡量策略对于指数变化的敏感性或相关性，
即如果上证指数上涨了1%，策略尚在了1.5%，那么贝塔就是1.5；反之，如果上证指数下跌了1%，策略下跌了1.5%，那么贝塔就是-1.5。所以，当市场处于牛市时，
贝塔值大的策略占优；当市场处于熊市时，贝塔值校的策略占优。贝塔通常也会被解释为系统性风险，当贝塔大于1时，表示策略的波动大于基准，当贝塔小于1时，
表示策略的波动小于基准。计算方法：Beta = Cov(Dp,Dm) / Var(Dm)  式中Cov（Dp,Dm）表示策略日收益序列和基准收益序列的协方差，Var（Dm）表示基准收益
序列的方差。

# 阿尔法
阿尔法表示的是策略在市场中面临的非系统性风险。他表示获取与市场波动无关的收益，也就是不依赖市场的上涨而获得的利益。简单而言，如一个策略获得了20%
的收益率，而基准获得了10%的收益率，那么阿利法就是10%

# 夏普比率
对量化投资来说，往往高收益伴随着高风险，很多人希望可以做到风险和收益的平衡。夏普比例就是用于衡量每承担一个单位的风险的情况下，所获得的无风险收益率
的超额回报是多少的指标。夏普比率越高，说明在承担一定风险的情况下，所获得的超额回报也就越高；反之，夏普比例越低甚至为负时，说明在承担一定风险的情况下，
所获得的超额回报越少或没有。所以，一般情况下，夏普比率越高越好。计算方法：
Sharpe Rate = (Rp - Rf) / Op  式中Rp表示策略的年华收益率，Rf表示无风险利率，Op表示策略收益的波动率（策略收益率的年化标准差）

# 最大回撤率
最大回撤率（Maximum Drawdown）同夏普比率一样，也是用于衡量策略风险的指标。它描述的是策略的最大亏损情况，即在一段时间内，资产从高峰跌落至低估的幅度。
因此，最大回撤率通常越小越好。计算方法：  最大回撤率 = （Px - Py） / Px  式中，Px和Py分别表示资产一段时间的最高值和最低值。

# 索提诺比率
索提诺比率（Sortino Ratio）与夏普比率类似，只不过前者表述的是策略在单位下行风险下所能获得的超额收益。这里的下行风险指的是向下波动的风险，也就是策略
亏损的风险。因此，索提诺比率与夏普比率一样，也是比率越高越好。计算公式：索提诺比率=（Rp - Rf） / Od
式中，Rp表示策略的年化收益率，Rf表示无风险收益率，Od表示策略的下行波动率。

# 胜率和盈亏比
胜率和盈亏比也是常用于衡量策略好坏的风险指标。胜率，顾名思义就是获胜的概率，在量化交易中就是指赚钱的交易次数除以总的交易次数，例如，在10次交易中，有
8次交易是赚钱的，那么胜率就是80%。而盈亏比指的是在总的交易中，盈利的金额除以亏损的金额，例如，在一段时间的交易中，盈利了12000，亏损了8000，那么，盈亏
比就是1.5。
所以，对于一个优秀的交易策略来说，胜率和盈亏比同等重要。但是大多数情况下，两者很难兼得。对于一些像CTA之类的策略来说，虽然胜率较低，但是盈亏比较高，也就
意味着虽然获利的次数较少，但是每次获利时可以得到很高的利润，这样就可以抵消多次的亏损，从而实现整体的盈利。还有就是像一些高频交易或配对交易策略，交易的次数
很多，但是平凡的开平仓获得的利润空间就会很少，这样的策略一般盈亏比较接近，但是胜率高，可以实现整体盈利。